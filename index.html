<!doctype html>
<html>

<style>
.shootingchart{
	background:url("img/nbahalfcourt.jpg")
}

.land {
  fill: white;
  stroke: black;
}

.county-boundary {
  fill: none;
  stroke: black;
  stroke-width: 1px;
}

.state-boundary {
  fill: none;
  stroke: black;
}

.GSW {
	background:url("img/GSW.jpg")
}
</style>
<head>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	
	<meta charset = "utf-8">
	<meta name="viewport" content = "width=device-width, initial-scale=1.0">
	<title> NBA GO </title>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/font-awesome.css" rel="stylesheet" type="text/css">
	<link href="css/main.css" rel="stylesheet" type="text/scc">
<style>

</style>
</head>

<body>
	<div class="container">
		<div class="col-md-1">
			<img src="img/NBA_logo.png" height="80">
		</div>
		
		<div class="col-md-10">
			<p><h1><a href="index.html"><strong>NBA GO</strong> </a></h1>
		</div>
	</div>
	
	<div class="container">	
		<div class="navbar navbar-default" style="margin:0px;">
			<div class="navbar-header col-md-1">
				<ul class="nav nav-pills">
				<li role="presentation" class="active"><a href="index.html">HOME</a></li>
			</ul>
		</div>
	</div>

<script src="//d3js.org/d3.v3.min.js"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>	
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
<script src="js/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>

</body>

<script>

	
	var containerDiv = d3.select("body")
							.attr("class", "row")
							.append("div")	
	
	var leftDiv= containerDiv
							.append("div")
							.attr("class", "col-md-1")

	var mainDiv = containerDiv
							.append("div")
							.attr("class", "col-md-10" )
	var rightDiv = containerDiv
							.append("div")								
							.attr("class", "col-md-1")
	var downDiv = containerDiv.append("div")

							
	var shootingChartDiv = d3.select("body")
							.attr("class", "container")
							.append("div")
							
	var courtimgwidth = 500
	var courtimgheight = 472
	var coordinateX = 50;
	var coordinateY = 47.2;
	
	var mapWidth = 960;
	var mapHeight = 500;
	
	
	var teamLogoWidth = 50;
	var teamLogoHeight = 50;
	
	leftDiv.append("p")
			.text("this is a testttttttttttttttt")
	
	rightDiv.append("p")
			.text("also is a testttttttttttttttt")	

	var tip = d3.tip()


			
	startPage();
	//shootingChart();
	function startPage(){
		
		var projection = d3.geo.albersUsa()
				//.scale(1000)
				.translate([mapWidth / 2, mapHeight / 2]);
	
		var path = d3.geo.path()
				.projection(projection);
		
		
		var usaMapSvg = mainDiv.append("svg")
						.attr("width", mapWidth)
						.attr("height", mapHeight)

						
		d3.json("datasets/usamap/usamap.json", function(error, us) {
		
			usaMapSvg.insert("path", ".graticule")
			  .datum(topojson.feature(us, us.objects.land))
			  .attr("class", "land")
			  .attr("d", path);
			/*
			usaMapSvg.insert("path", ".graticule")
			  .datum(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && !(a.id / 1000 ^ b.id / 1000); }))
			  .attr("class", "county-boundary")
			  .attr("d", path);
			*/
			usaMapSvg.insert("path", ".graticule")
			  .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
			  .attr("class", "state-boundary")
			  .attr("d", path);
			
		})
		
		d3.csv("datasets/usamap/arenaCoordinates.csv", function(err, d){
			var coordinates = [];
	
			d.forEach(function(d, i)
			{
				d.longtitude = +d.longtitude;
				d.latitude = +d.latitude;
				coordinates[i] = new Array();
				coordinates[i] = projection([d.longtitude,d.latitude])
			})		

		
		tip.attr('class', 'd3-tip')
			.offset([-10, 0])
			.html(function(d) {
				return "<img src=\"img\/" + d.T +".jpg\" height=\"100\"></img>" 
				+ "<p><strong>"+ d.Team +"</strong> <span style='color:red'></p>"
				+ "<p><strong>Offensive Rating:</strong> <span style='color:red'>" + d.ORtg + "</span></p>"
				+ "<p><strong>Deffensive Rating:</strong> <span style='color:red'>" + d.DRtg + "</span></p>"
				+ "<p><strong>Pace:</strong> <span style='color:red'>" + d.Pace + "</span></p>";
			})

		usaMapSvg.call(tip);
		
			var teamLogoGroup = usaMapSvg.selectAll("g")
					.data(d)
					.enter()
						.append("g")
			
			var defs = teamLogoGroup.append("defs").attr("id", "imgdefs")
			
			
			var catpattern = defs.append("pattern")
                        .attr("id", "catpattern")
                        .attr("height", 1)
                        .attr("width", 1)
                        .attr("x", "0")
                        .attr("y", "0")
			
			catpattern.append("image")
							.attr("xlink:href",function(d,i){return "img/" +  d.T + ".jpg"} )
							.attr("x", 0)
							.attr("y", 0)
							.attr("width",teamLogoWidth)
							.attr("height", teamLogoHeight)	
						
			circles = teamLogoGroup.append("circle")
					.attr("cx", function (d, i){var co = coordinates[i];return co[0];})
					.attr("cy", function (d, i){var co = coordinates[i];return co[1];})
					.attr("r", 25)
					.attr("fill", "url(#catpattern)")
						.on('mouseover', tip.show)
						.on('mouseout', tip.hide)
			
			/*				
				teamLogoSvgs = teamLogoGroup.append("svg")	
							//.attr("src", function(d,i){return "/img/" +  d.T + ".jpg)"})
							.attr("width",teamLogoWidth)
							.attr("height", teamLogoHeight)		
						//	.attr("transform", function(d,i) {var co = coordinates[i]; return "translate(" + co[0] + "," + co[1]+")"})							
						.attr("x", function (d, i){var co = coordinates[i];return co[0] - teamLogoWidth /2;})
						.attr("y", function (d, i){var co = coordinates[i];return co[1] - teamLogoHeight / 2;})

					
				teamLogoSvgs.append("image")
							.attr("xlink:href",function(d,i){return "img/" +  d.T + ".jpg"} )
							.attr("x", 0)
							.attr("y", 0)
							.attr("width",teamLogoWidth)
							.attr("height", teamLogoHeight)	
				*/
		})

	}
	
	
	function shootingChart(team)
	{
		
		d3.csv("datasets/2006-2007.regular_season/20061031.PHXLAL.csv", function(err, d){
			if(err) console.log(err);
			var maxx = 0;
			var maxy = 0;
			d.forEach(function(d)
			{
				d.x = +d.x;
				d.y = +d.y;
				console.log("coordinates " + d.period + " " + d.time + " : " + d.x + "," + d.y);
			})

			shootingChartDiv.append("div")
			
			var shootsvg = shootingChartDiv.append("svg")	
						.attr("width", courtimgwidth)
						.attr("height", courtimgheight)
						.attr("class", "shootingchart")
				
			var xscale = d3.scale.linear()
							.domain([0, coordinateX])
							.range([0, courtimgwidth]);
							
			var yscale = d3.scale.linear()
							.domain([0, coordinateY])
							.range([0, courtimgwidth]);
			
			console.log(maxy);
			
			shotgroup = shootsvg.selectAll("g")
					.data(d)
					.enter()
						.append("g")
						
			shotgroup.append("circle")		
						.attr("transform", function (d, i){return "translate(" + (courtimgwidth - xscale(d.x)) + "," + (yscale(d.y) - 5.25) + ")" })
						.attr("r",5)
						.attr("fill", function(d){
						if(d.result == "made") return "red";
						else if(d.result == "missed") return "green";
										})
						.attr("opacity", function (d, i){
							if(d.team == "PHX") return 1;
							else if(d.team == "LAL") return 0;
						
						})
						
			
		})
	}

</script>